(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4ccf8432"],{"09ec":function(e,t,n){"use strict";var o=n("c929"),a=n.n(o);a.a},"1b62":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var o={data:function(){return{form:{},formLabelWidth:"100px"}},methods:{cancelHandle:function(){this.$emit("cancelHandle")},confirmHandle:function(){this.$emit("confirmHandle",this.form)}}},a={methods:{handleAdd:function(){this.$emit("handleAdd","新增")},handleView:function(e){this.$emit("handleView","查看",e)},handleEdit:function(e){this.$emit("handleEdit","编辑",e)}}}},"28f2":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("search-role",{on:{search:e.onSearch,addRole:function(t){return e.showRole("新建")}}}),e._v(" "),n("role-list",{attrs:{data:e.roleData},on:{handleView:e.showRole,handleEdit:e.showRole,deleteRole:e.getRoleList}}),e._v(" "),e.roleConfig.status?n("role-dialog",{ref:"roleCont",attrs:{config:e.roleConfig,"role-action":e.menuList,"role-data":e.roleInfo},on:{cancelHandle:e.cancelRoleOpt,confirmHandle:e.confirmRoleOpt}}):e._e(),e._v(" "),n("div",{staticClass:"pagination-container"},[n("pagination",{attrs:{total:e.total,page:e.listQuery.pageNo,limit:e.listQuery.pageSize},on:{"update:page":function(t){return e.$set(e.listQuery,"pageNo",t)},"update:limit":function(t){return e.$set(e.listQuery,"pageSize",t)},pagination:e.getRoleList}})],1)],1)},a=[],r=n("db72"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.condition}},[n("el-form-item",{attrs:{label:"角色名"}},[n("el-input",{attrs:{placeholder:"请输入角色名",clearable:""},model:{value:e.condition.gradeName,callback:function(t){e.$set(e.condition,"gradeName",t)},expression:"condition.gradeName"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"描述"}},[n("el-input",{attrs:{placeholder:"请输入描述",clearable:""},model:{value:e.condition.gradeDesc,callback:function(t){e.$set(e.condition,"gradeDesc",t)},expression:"condition.gradeDesc"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{icon:"el-icon-search",type:"primary"},on:{click:e.onSearch}},[e._v("查询")])],1),e._v(" "),n("el-form-item",[n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["coreRoleList:add"],expression:"['coreRoleList:add']"}],attrs:{icon:"el-icon-circle-plus-outline",type:"primary"},on:{click:e.addRole}},[e._v("新增")])],1)],1)},l=[],s={name:"SearchRole",data:function(){return{condition:{gradeName:null,gradeDesc:null}}},methods:{onSearch:function(){this.$emit("search",this.condition)},addRole:function(){this.$emit("addRole")}}},c=s,u=n("2877"),d=Object(u["a"])(c,i,l,!1,null,null,null),f=d.exports,m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-table",{attrs:{data:e.data,"row-key":"id","default-sort":{prop:"roleName"},border:""}},[n("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"80"}}),e._v(" "),n("el-table-column",{attrs:{label:"角色名称",prop:"gradeName",sortable:""}}),e._v(" "),n("el-table-column",{attrs:{label:"角色描述",prop:"gradeDesc",sortable:""}}),e._v(" "),n("el-table-column",{attrs:{label:"创建时间",prop:"createTime"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e._f("parseTime")(t.row.createTime,"{y}-{m}-{d}")))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"更改时间",prop:"updateTime"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e._f("parseTime")(t.row.updateTime,"{y}-{m}-{d}")))])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"操作",width:"210"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text"},on:{click:function(n){return e.handleView(t.row)}}},[e._v("查看")]),e._v(" "),n("el-button",{attrs:{type:"text"},on:{click:function(n){return e.handleEdit(t.row)}}},[e._v("编辑")]),e._v(" "),n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["coreRoleList:delete"],expression:"['coreRoleList:delete']"}],attrs:{type:"text"},on:{click:function(n){return e.handleDelete(t.row.id)}}},[e._v("删除")])]}}])})],1)},h=[],p=n("1b62"),g=n("b775"),b={getRoleList:function(e){return Object(g["a"])({url:"/grade/queryGrades",method:"post",data:e})},saveRoleInfo:function(e){return Object(g["a"])({url:"/grade/createGradePage",method:"post",data:e})},updateRole:function(e){return Object(g["a"])({url:"/grade/updateGradePage",method:"post",data:e})},getRolePermission:function(e){return Object(g["a"])({url:"/grade/queryGradeTask",method:"post",data:e})},deleteRole:function(e){return Object(g["a"])({url:"/grade/deleteGrade",method:"post",data:e})}},v={name:"RoleList",mixins:[p["b"]],props:{data:{type:Array,default:function(){return[]}}},methods:{handleDelete:function(e){var t=this;this.$Msgbox.$confirm({text:"此操作将永久删除该菜单, 是否继续?"}).then((function(){b.deleteRole({id:e}).then((function(e){"0000"===e.resultCode?(t.$message({type:"success",message:e.resultMsg}),t.$emit("deleteRole")):t.$message({type:"error",message:e.resultMsg})}))}))}}},y=v,R=Object(u["a"])(y,m,h,!1,null,null,null),_=R.exports,k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"},{name:"drag-resize",rawName:"v-drag-resize"}],attrs:{"close-on-click-modal":!1,title:e.config.title,visible:e.config.status,"before-close":e.cancelHandle},on:{"update:visible":function(t){return e.$set(e.config,"status",t)}}},[n("el-form",{ref:"roleForm",attrs:{model:e.form,rules:e.formRules,"label-width":e.formLabelWidth}},[n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"角色名称",prop:"gradeName"}},[n("el-input",{attrs:{type:"text",placeholder:"请填写角色名称",disabled:e.isView},model:{value:e.form.gradeName,callback:function(t){e.$set(e.form,"gradeName",t)},expression:"form.gradeName"}})],1)],1),e._v(" "),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"角色描述",prop:"gradeDesc"}},[n("el-input",{attrs:{type:"text",placeholder:"请填写角色描述",disabled:e.isView},model:{value:e.form.gradeDesc,callback:function(t){e.$set(e.form,"gradeDesc",t)},expression:"form.gradeDesc"}})],1)],1)],1),e._v(" "),n("el-form-item",{attrs:{label:"菜单&权限"}},[n("el-tree",{ref:"tree",staticClass:"permission-box",class:["permission-tree"],attrs:{data:e.roleAction,"check-strictly":e.checkStrictly,"default-checked-keys":e.checkedKeys,"default-expanded-keys":e.isView?e.expandedKeys:[],props:e.defaultProps,"node-key":"taskCode","show-checkbox":""}})],1)],1),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.cancelHandle}},[e._v("取 消")]),e._v(" "),e.isView?e._e():n("el-button",{attrs:{type:"primary"},on:{click:e.confirmHandle}},[e._v("保 存")])],1)],1)},w=[],$=(n("ac6a"),n("75fc")),S=n("61f7"),C={name:"ChangePassword",mixins:[p["a"]],props:{config:{type:Object,default:function(){return{}}},roleAction:{type:Array,default:function(){return[]}},roleData:{type:Object,default:function(){return{}}}},data:function(){return{form:{gradeName:null,gradeDesc:null},formRules:{gradeName:[{required:!0,message:"角色名称不能为空，请填写",trigger:"blur"}],gradeDesc:[{required:!0,message:"角色描述不能为空，请填写",trigger:"blur"}]},checkStrictly:!1,defaultProps:{label:"menuCname",children:"childMenus"},allPermIds:[],checkedKeys:[],allPermissions:[],roleActions:[]}},computed:{isView:function(){return"查看角色"===this.config.title},isEdit:function(){return"编辑角色"===this.config.title},expandedKeys:function(){return"查看角色"===this.config.title?this.getAllPermId(this.allPermissions):[]}},mounted:function(){this.form.gradeName=this.roleData.gradeName,this.form.gradeDesc=this.roleData.gradeDesc,this.form.gradeId=this.roleData.id,this.rolePermission(this.roleData.id),this.allPermissions=Object($["a"])(this.roleAction),"查看角色"===this.config.title?this.recursionFun(this.roleAction):this.reRecursionFun(this.roleAction)},methods:{recursionFun:function(e){var t=this;e.map((function(e){e.disabled=!0,Object(S["c"])(e.childMenus)&&e.childMenus.length>0&&t.recursionFun(e.childMenus)}))},reRecursionFun:function(e){var t=this;e.map((function(e){e.disabled=!1,Object(S["c"])(e.childMenus)&&e.childMenus.length>0&&t.reRecursionFun(e.childMenus)}))},confirmHandle:function(){var e=this;this.$refs["roleForm"].validate((function(t){if(t){var n=e.$refs.tree.getCheckedKeys(),o=e.$refs.tree.getHalfCheckedKeys(),a=e.isEdit?"update":"new";e.isEdit?(e.form.finalActions=[].concat(Object($["a"])(n),Object($["a"])(o)),e.form.roleActions=e.roleActions):e.form.roleActions=[].concat(Object($["a"])(n),Object($["a"])(o)),e.$emit("confirmHandle",e.form,e.$refs["roleForm"],a)}}))},rolePermission:function(e){var t=this;this.checkStrictly=!0,b.getRolePermission({gradeId:e}).then((function(e){if("0000"===e.resultCode)if(0===e.resultObj.roleActions.length)t.$refs.tree.setCheckedKeys([]),t.checkStrictly=!1;else{var n=e.resultObj.roleActions.map((function(e){return e}));t.roleActions=n,t.$refs.tree.setCheckedKeys(n),t.$nextTick((function(){t.checkStrictly=!0}))}}))},getAllPermId:function(e){var t=this,n=[];return e.forEach((function(e){e.childMenus&&e.childMenus.length>0&&t.getAllPermId(e.childMenus),n.push(e.taskCode)})),this.allPermIds=[].concat(Object($["a"])(this.allPermIds),n),this.allPermIds},setDisabled:function(e){var t=this;e.forEach((function(e){e.childMenus&&e.childMenus.length>0?(e.disabled=!0,t.setDisabled(e.childMenus)):e.disabled=!0}))}}},N=C,O=(n("ba36"),Object(u["a"])(N,k,w,!1,null,null,null)),x=O.exports,P=n("333d"),j={name:"CoreRoleList",components:{SearchRole:f,RoleList:_,RoleDialog:x,Pagination:P["a"]},data:function(){return{defaultProps:{children:"children",label:"label"},roleData:[],listQuery:{pageNo:1,pageSize:10},total:0,roleConfig:{status:!1,title:"新建角色"},roleInfo:{id:null,roleName:null,desc:null},menuList:[]}},created:function(){var e=this;0===this.menuList.length&&this.$store.dispatch("getMenuTree").then((function(t){e.menuList=t.resultObj.menuTree})),this.getRoleList()},methods:{getRoleList:function(e){var t=this;b.getRoleList(e||this.listQuery).then((function(e){t.roleData=e.resultObj.list,t.total=e.resultObj.totalCount}))},onSearch:function(e){this.listQuery=Object(r["a"])({},this.listQuery,{},e),this.getRoleList()},showRole:function(e,t){this.roleInfo=Object(r["a"])({},t),this.roleConfig.title="".concat(e,"角色"),this.roleConfig.status=!0},cancelRoleOpt:function(){this.$refs.roleCont.$refs.roleForm.resetFields();var e=this.$refs.roleCont.$refs.tree;e.setCheckedKeys([]);for(var t=0;t<e.store._getAllNodes().length;t++)e.store._getAllNodes()[t].expanded=!1;this.roleConfig.status=!1},confirmRoleOpt:function(e,t,n){var o,a=this;o="update"===n?b.updateRole(e):b.saveRoleInfo(e),o.then((function(e){"0000"===e.resultCode?(a.$message({type:"success",message:e.resultMsg}),a.cancelRoleOpt(),a.getRoleList(),t.resetFields(),a.roleConfig.status=!1):a.$message({type:"error",message:e.resultMsg})})).catch((function(e){a.$message({type:"error",message:e.msg})}))}}},z=j,A=Object(u["a"])(z,o,a,!1,null,null,null);t["default"]=A.exports},"333d":function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[n("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},a=[];n("c5f6");Math.easeInOutQuad=function(e,t,n,o){return e/=o/2,e<1?n/2*e*e+t:(e--,-n/2*(e*(e-2)-1)+t)};var r=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function i(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function l(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function s(e,t,n){var o=l(),a=e-o,s=20,c=0;t="undefined"===typeof t?500:t;var u=function e(){c+=s;var l=Math.easeInOutQuad(c,o,a,t);i(l),c<t?r(e):n&&"function"===typeof n&&n()};u()}var c={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:pageNo",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.$emit("update:pageSize",e)}}},methods:{handleSizeChange:function(e){console.log("pageSize1:",e,"pageNo1",this.currentPage),this.$emit("pagination",{pageNo:this.currentPage,pageSize:e}),this.autoScroll&&s(0,800)},handleCurrentChange:function(e){console.log("pageSize2:",this.pageSize,"pageNo2",e),this.$emit("pagination",{pageNo:e,pageSize:this.pageSize}),this.autoScroll&&s(0,800)}}},u=c,d=(n("09ec"),n("2877")),f=Object(d["a"])(u,o,a,!1,null,"c0d46590",null);t["a"]=f.exports},b6c6:function(e,t,n){},ba36:function(e,t,n){"use strict";var o=n("b6c6"),a=n.n(o);a.a},c929:function(e,t,n){}}]);